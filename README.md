# Fastify, yjs, websocket app

To install dependencies: 

```bash
yarn install
```

To run:

```bash
yarn run start
```

Tip:
```bash
curl http://localhost:4000/documents/:documentId/language/:languageId
```
Проект **datikken/collab** — это **минималистичный бэкенд-сервер** для **реального времени совместного редактирования** (collaborative editing). Он построен как простое приложение на стеке **Fastify + Yjs + WebSocket** и предназначен для демонстрации или базовой реализации многопользовательского редактирования документов.

### Основные характеристики проекта
- Очень лёгкий и минимальный пример (без лишних зависимостей и сложной логики)
- Сервер на **Node.js** + **Fastify** (быстрый веб-фреймворк)
- **WebSocket** для передачи обновлений в реальном времени
- **Yjs** — современная CRDT-библиотека (Conflict-free Replicated Data Type), которая отвечает за разрешение конфликтов при одновременном 
редактировании без центрального сервера-координатора (offline-first, peer-to-peer friendly)
- Поддержка маршрутизации документов по ID:  
  `http://localhost:4000/documents/:documentId/language/:languageId`  
  (можно открыть один и тот же документ с разных клиентов — изменения синхронизируются мгновенно)
- Написан на **TypeScript**, собирается через **tsup**, есть **Dockerfile** для контейнеризации
- Есть папка `dev-cluster` — вероятно, для локального тестирования нескольких инстансов

Проект напрямую использует **Yjs** + **WebSocket** + **Node.js** — это именно та часть стека, которая отвечает за **совместное редактирование**

Однако в самом репозитории **нет**:
- **ProseMirror** (и его схемы / модели документа)
- **Redis** (persistence / брокер)
- фронтенд-части с **ProseMirror**-редактором
- Markdown-парсинга / сериализации

Это **только серверная / транспортная часть** для коллаборации.  
Чтобы получить полноценный совместный редактор, обычно комбинируют именно такой бэкенд с фронтендом на **ProseMirror** + **y-prosemirror** (официальная привязка Yjs к ProseMirror).

### Типичная полная схема
- **Фронтенд**  
  ProseMirror (ядро редактора)  
  ↓  
  y-prosemirror (привязка к Yjs, shared cursors, undo/redo, schema validation)  
  ↓  
  Y.Doc / Y.XmlFragment (модель совместных данных)

- **Бэкенд / транспорт** ← именно то, что в datikken/collab  
  Yjs провайдер (y-websocket или кастом на Fastify + ws)  
  WebSocket-соединение  
  (опционально Redis / y-redis для persistence при большом количестве пользователей)

- **Результат** — несколько пользователей редактируют один документ одновременно, курсоры видны, конфликты разрешаются автоматически, можно переключаться между WYSIWYG и markdown-режимом (если фронт это поддерживает).

Если коротко:  
**datikken/collab** — это готовый, очень простой **Yjs + WebSocket сервер на Fastify**, который можно сразу использовать как основу для совместного редактора на **ProseMirror**.  

Для любителей видео: https://www.youtube.com/watch?v=7XplHnIdnWw
